---
title: Brightcove Interactivity Extension API
description: The Extension API provides the ability to ‘extend’ the capability of the platform by creating your own custom annotation.
parent: Brightcove Interactivity APIs
---

<h1>{{ page.title }}</h1>
<article class="bcls-article">
  <summary>{{ page.description }}</summary>
          <div name="ExtensionAPI" data-unique="ExtensionAPI"></div><h1>Extension API</h1>
<p>The Extension API provides the ability to ‘extend’ the capability of the platform by creating your own custom annotation.</p>
<p><strong>Steps to use Extension API</strong></p>
<ol>
<li>
<p>Located in the project editor view, click on the <img alt="alt text" src="https://hapyak-documentation.s3.amazonaws.com/extension-api/content/images/Screen+Shot+2019-06-04+at+3.40.46+PM.png"> icon to open the widget library menu.
<img alt="alt text" src="https://hapyak-documentation.s3.amazonaws.com/extension-api/content/images/extension-api-4.png"></p>
</li>
<li>
<p>From here, click the HTML tab. This block of code contains all of the necessary scripts to get started. Editing the raw HTMLboiler-plate code gives you the freedom to build a custom extension or annotation tailored to your needs. <br>
<img alt="alt text" src="https://hapyak-documentation.s3.amazonaws.com/extension-api/content/images/extension-api-5.png"></p>
</li>
</ol>
<p>This example represents a good starting point:</p>
<div class="highlight"><pre>  <span class="cp">&lt;!doctype html&gt;</span>
<span class="nt">&lt;html&gt;</span>
  <span class="nt">&lt;head&gt;</span>
      <span class="nt">&lt;title&gt;&lt;/title&gt;</span>
      <span class="nt">&lt;meta</span> <span class="na">charset=</span><span class="s">"utf-8"</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;style</span> <span class="na">type=</span><span class="s">"text/css"</span><span class="nt">&gt;</span>
          html, body { margin: 0; padding: 0 }
      <span class="nt">&lt;/style&gt;</span>
  <span class="nt">&lt;/head&gt;</span>
  <span class="nt">&lt;body&gt;</span>
      <span class="c">&lt;!-- HTML code goes here --&gt;</span>

      <span class="nt">&lt;script</span> <span class="na">type=</span><span class="s">"text/javascript"</span> <span class="na">src=</span><span class="s">"//d2qrdklrsxowl2.cloudfront.net/js/hapyak-iframe.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
      <span class="nt">&lt;script</span> <span class="na">type=</span><span class="s">"text/javascript"</span> <span class="na">src=</span><span class="s">"//d2qrdklrsxowl2.cloudfront.net/js/hapyak.api.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
      <span class="nt">&lt;script</span> <span class="na">type=</span><span class="s">"text/javascript"</span><span class="nt">&gt;</span>
          (function () {
              /*
              Write your script code here
              */

              hapyak.context.addEventListener('data', function (variables) {
                  /*
                  Access Environment variables here
                  */
              });
          }());
      <span class="nt">&lt;/script&gt;</span>
  <span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</pre></div>


<div name="Player" data-unique="Player"></div><h2>Player</h2>
<h4>Object: hapyak.context.player</h4>
<div name="METHOD:play()" data-unique="METHOD:play()"></div><h3><strong>METHOD: play()</strong></h3>
<p><code>hapyak.context.player.play()</code></p>
<ul>
<li>Plays the video</li>
</ul>
<div name="METHOD:pause()" data-unique="METHOD:pause()"></div><h3><strong>METHOD: pause()</strong></h3>
<p><code>hapyak.context.player.pause()</code></p>
<ul>
<li>Pauses the video</li>
</ul>
<div name="METHOD:mute()" data-unique="METHOD:mute()"></div><h3><strong>METHOD: mute()</strong></h3>
<p><code>hapyak.context.player.mute()</code></p>
<ul>
<li>Mutes the video</li>
</ul>
<div name="METHOD:unmute()" data-unique="METHOD:unmute()"></div><h3><strong>METHOD: unmute()</strong></h3>
<p><code>hapyak.context.player.pause()</code></p>
<ul>
<li>unmutes the video</li>
</ul>
<div name="METHOD:volume()" data-unique="METHOD:volume()"></div><h3><strong>METHOD: volume()</strong></h3>
<p><code>hapyak.context.player.volume()</code></p>
<ul>
<li>Passing no arguments to this function returns a number between 0 to 1 representing the current volume.</li>
</ul>
<p><code>hapyak.context.player.volume(0.5)</code></p>
<ul>
<li>Passing a number between 0-1 will set the volume of the player to that value.</li>
</ul>
<div name="METHOD:addClass,removeClass" data-unique="METHOD:addClass,removeClass"></div><h3><strong>METHOD: addClass, removeClass</strong></h3>
<p><code>addClass(classNames, selector) and removeClass(classNames, selector)</code></p>
<p>Set or remove CSS classes on the IFRAME annotation where: <br></p>
<ul>
<li><code>classNames</code> (string or array) <br>
<code>classNames</code> can be a single class e.g <code>myAwesomeClass</code> or an array of classes <code>['class1', 'class2']</code> <br></li>
<li><code>selector</code> (optional) <br>
 is used to target an existing class, id, or DOM element on the player element and add the class(es) to that element. If a selector is not passed in, the class will be added to the parent div within the iframe. <br></li>
</ul>
<p><code>selector</code> (optional) is used to target an existing class, id, or DOM element on the player element and add the class(es) to that element. <br></p>
<p><strong>examples:</strong> <br></p>
<ul>
<li><code>hapyak.context.player.addClass('myClass', 'div#wrapper &gt; h1)</code></li>
<li><code>hapyak.context.player.removeClass('myClass', 'div#wrapper &gt; .exampleElement')</code></li>
</ul>
<p><br></p>
<div name="PROPERTY:paused" data-unique="PROPERTY:paused"></div><h3><strong>PROPERTY: paused</strong><br></h3>
<p><em>READ ONLY</em></p>
<p><code>var playerPaused = hapyak.context.player.paused</code></p>
<ul>
<li>Get whether video is paused or not</li>
</ul>
<div name="PROPERTY:duration" data-unique="PROPERTY:duration"></div><h3><strong>PROPERTY: duration</strong><br></h3>
<p><em>READ ONLY</em></p>
<p><code>var videoLength = hapyak.context.player.paused //duration in seconds</code></p>
<ul>
<li>returns video duration (unit: seconds)</li>
</ul>
<div name="PROPERTY:currentTime" data-unique="PROPERTY:currentTime"></div><h3><strong>PROPERTY: currentTime</strong><br></h3>
<p><em>READ / WRITE</em></p>
<p><code>var currentTime = hapyak.context.player.currentTime //returns time in seconds</code></p>
<ul>
<li>can be used to Get current video time (unit: seconds)</li>
</ul>
<p><code>hapyak.context.player.currentTime = 20 //will jump to 20 seconds</code></p>
<ul>
<li>can also be used to set the current time of the video (jump to time)</li>
</ul>
<div name="PROPERTY:isEditMode" data-unique="PROPERTY:isEditMode"></div><h3><strong>PROPERTY: isEditMode</strong><br></h3>
<p><em>READ ONLY</em></p>
<p><code>hapyak.context.player.isEditMode</code></p>
<ul>
<li>Returns true if the IFRAME is being displayed inside a HapYak editor</li>
</ul>
<div name="PROPERTY:isEditing" data-unique="PROPERTY:isEditing"></div><h3><strong>PROPERTY: isEditing</strong><br></h3>
<p><em>READ ONLY</em></p>
<p><code>hapyak.context.player.isEditing</code></p>
<ul>
<li>Returns true if the IFRAME is currently being edited</li>
</ul>
<p><br></p>
<div name="Object:Annotation" data-unique="Object:Annotation"></div><h2>Object: Annotation</h2>
<div name="IMPORTANTNOTE" data-unique="IMPORTANTNOTE"></div><h3>IMPORTANT NOTE</h3>
<p>In order to set properties, the iFrame must be visible. The following example is one recommended way to ensure that the iframe is shown prior to attempting a resize.</p>
<div class="highlight"><pre><span class="nx">hapyak</span><span class="p">.</span><span class="nx">context</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">'iframeshow'</span><span class="p">,</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
  <span class="nx">hapyak</span><span class="p">.</span><span class="nx">context</span><span class="p">.</span><span class="nx">width</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">'.hapyak-iframe-container'</span><span class="p">).</span><span class="nx">offsetWidth</span><span class="p">;</span>
<span class="p">});</span>
</pre></div>


<div name="METHOD:releaseGate()" data-unique="METHOD:releaseGate()"></div><h3><strong>METHOD: releaseGate()</strong></h3>
<p><code>hapyak.context.releaseGate()</code></p>
<p>A gate restricts the progress of a viewer in the video, requiring that they interact with an annotation prior to continuing on. In the extension api, you must explicitly state when a gate is to be relased.
To set a gate, toggle the respective option in the edit tab on the annotation to <code>y</code> as seen in this screenshot:</p>
<p><img alt="alt text" src="https://hapyak-documentation.s3.amazonaws.com/extension-api/content/images/gate.png"></p>
<ul>
<li>If the IFRAME is set to be gated, calling this method will release that gate.</li>
</ul>
<div name="PROPERTY:annotationData" data-unique="PROPERTY:annotationData"></div><h3><strong>PROPERTY: annotationData</strong></h3>
<p><br>
<em>READ ONLY</em></p>
<p><code>hapyak.context.annotationData</code></p>
<ul>
<li>Returns list of current annotation's properties. From here we can gain access to group and project configuration elements, including group and project level css. It is good practice to maintain styling by adding your group and project level CSS to the extension. In order to return this object, you must wait for the annotation to load:</li>
</ul>
<div class="highlight"><pre><span class="nx">hapyak</span><span class="p">.</span><span class="nx">context</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">'annotationload'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(){</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"annotation Data"</span><span class="p">,</span> <span class="nx">hapyak</span><span class="p">.</span><span class="nx">context</span><span class="p">.</span><span class="nx">annotationData</span><span class="p">)</span>
<span class="p">});</span>
</pre></div>


<div name="PROPERTY:width" data-unique="PROPERTY:width"></div><h3><strong>PROPERTY: width</strong><br></h3>
<p><em>READ / WRITE</em></p>
<p><code>hapyak.context.width = pixels</code></p>
<ul>
<li>Sets or gets the width of the IFRAME element.</li>
</ul>
<div name="PROPERTY:height" data-unique="PROPERTY:height"></div><h3><strong>PROPERTY: height</strong> <br></h3>
<p><em>READ / WRITE</em></p>
<p><code>hapyak.context.height = pixels</code></p>
<ul>
<li>Sets or gets the IFRAME element.</li>
</ul>
<div name="Events" data-unique="Events"></div><h2>Events</h2>
<p>Events are accessed through event listeners on the hapyak.context object:</p>
<div class="highlight"><pre><span class="nx">hapyak</span><span class="p">.</span><span class="nx">context</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s2">"event"</span><span class="p">,</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
  <span class="c1">//do something here</span>
<span class="p">});</span>
</pre></div>


<p><br></p>
<div name="annotationload" data-unique="annotationload"></div><h3><strong>annotationload</strong></h3>
<div class="highlight"><pre><span class="nx">hapyak</span><span class="p">.</span><span class="nx">context</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s2">"annotationload"</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span>
<span class="p">});</span>
</pre></div>


<ul>
<li>
<p>Emitted when the current annotation loads.   </p>
</li>
<li>
<p>The object emitted by this event contains data related to the annotation, as well as group, and project configuration data.</p>
</li>
</ul>
<div class="highlight"><pre><span class="p">{</span>
<span class="nl">top:</span> <span class="s">"19.999999999999993%"</span><span class="p">,</span>
<span class="nl">left:</span> <span class="s">"20%"</span><span class="p">,</span>
<span class="nl">width:</span> <span class="s">"60%"</span><span class="p">,</span>
<span class="nl">height:</span> <span class="s">"60%"</span><span class="p">,</span>
<span class="nl">duration:</span> <span class="mi">3</span><span class="p">,</span>
<span class="nl">durationFormat:</span> <span class="s">"seconds"</span>
<span class="nl">durationValue:</span> <span class="mi">3</span>
<span class="nl">end:</span> <span class="mf">6.2256</span>
<span class="nl">groupConfig:</span> <span class="p">{</span><span class="n">gates</span><span class="o">:</span> <span class="nb">true</span><span class="p">,</span> <span class="n">minWidth</span><span class="o">:</span> <span class="s">"0"</span><span class="p">,</span> <span class="n">iframeTimeout</span><span class="o">:</span> <span class="mi">30000</span><span class="p">}</span>
<span class="nl">height:</span> <span class="s">"60%"</span>
<span class="nl">id:</span> <span class="s">"iframe1560519550307"</span>
<span class="nl">left:</span> <span class="s">"20%"</span>
<span class="nl">projectConfig:</span> <span class="p">{</span><span class="n">css</span><span class="o">:</span> <span class="s">""</span><span class="p">,</span> <span class="n">title</span><span class="o">:</span> <span class="s">"Extension API example"</span><span class="p">},</span>
<span class="nl">projectId:</span> <span class="mi">284539</span>
<span class="nl">projectTrackId:</span> <span class="mi">575497</span>
<span class="nl">start:</span> <span class="mf">3.2256</span>
<span class="nl">startTimeFormat:</span> <span class="s">"seconds"</span>
<span class="nl">startTimeValue:</span> <span class="mf">3.2256</span>
<span class="p">}</span>
</pre></div>


<p><br></p>
<div name="loadedmetadata" data-unique="loadedmetadata"></div><h3><strong>loadedmetadata</strong></h3>
<div class="highlight"><pre><span class="nx">hapyak</span><span class="p">.</span><span class="nx">context</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s2">"loadedmetadata"</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span>
<span class="p">});</span>
</pre></div>


<ul>
<li>Emitted when the HapYak metadata has finished loading.</li>
</ul>
<p><br></p>
<div name="data" data-unique="data"></div><h3><strong>data</strong></h3>
<div class="highlight"><pre><span class="nx">hapyak</span><span class="p">.</span><span class="nx">context</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s2">"data"</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
<span class="p">});</span>
</pre></div>


<ul>
<li>The 'data' event will fire anytime there is a change in the environment variables. This happens often. Below is an example of the object that is returned.</li>
</ul>
<div class="highlight"><pre><span class="p">{</span>
<span class="nl">annotationIds:</span> <span class="p">{</span><span class="mi">1457229</span><span class="o">:</span> <span class="nb">true</span><span class="p">,</span> <span class="mi">1457445</span><span class="o">:</span> <span class="nb">true</span><span class="p">,</span> <span class="mi">1457474</span><span class="o">:</span> <span class="nb">true</span><span class="p">,</span> <span class="mi">1457475</span><span class="o">:</span> <span class="nb">true</span><span class="p">}</span>
<span class="nl">annotationsLoaded:</span> <span class="nb">true</span>
<span class="nl">configuration:</span> <span class="p">{</span><span class="n">gates</span><span class="o">:</span> <span class="nb">true</span><span class="p">,</span> <span class="n">minWidth</span><span class="o">:</span> <span class="s">"0"</span><span class="p">,</span> <span class="n">iframeTimeout</span><span class="o">:</span> <span class="mi">30000</span><span class="p">,}</span>
<span class="nl">projectAnnotations:</span> <span class="p">{</span><span class="mi">1457229</span><span class="o">:</span> <span class="p">{},</span> <span class="mi">1457445</span><span class="o">:</span> <span class="p">{},</span> <span class="mi">1457474</span><span class="o">:</span> <span class="p">{},</span> <span class="mi">1457475</span><span class="o">:</span> <span class="p">{}}</span>
<span class="nl">projectConfig:</span> <span class="p">{</span><span class="n">css</span><span class="o">:</span> <span class="s">""</span><span class="p">,</span> <span class="n">title</span><span class="o">:</span> <span class="s">"Extension API example"</span><span class="p">}</span>
<span class="nl">projectId:</span> <span class="mi">284539</span>
<span class="nl">projectName:</span> <span class="s">"Extension API example"</span>
<span class="p">}</span>
</pre></div>


<p><br></p>
<div name="iframeshow" data-unique="iframeshow"></div><h3><strong>iframeshow</strong></h3>
<div class="highlight"><pre><span class="nx">hapyak</span><span class="p">.</span><span class="nx">context</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s2">"iframeshow"</span><span class="p">,</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'Iframe has appeared'</span><span class="p">);</span>
<span class="p">});</span>
</pre></div>


<ul>
<li>Emitted when the IFRAME annotation enters its start time &amp; is shown</li>
</ul>
<div name="timeupdate" data-unique="timeupdate"></div><h3><strong>timeupdate</strong></h3>
<div class="highlight"><pre><span class="nx">hapyak</span><span class="p">.</span><span class="nx">context</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s2">"timeupdate"</span><span class="p">,</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
  <span class="c1">// prints current time of video to the console</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">hapyak</span><span class="p">.</span><span class="nx">context</span><span class="p">.</span><span class="nx">player</span><span class="p">.</span><span class="nx">currentTime</span><span class="p">);</span>
<span class="p">});</span>
</pre></div>


<ul>
<li>Emitted when the current video time changes, and at a regular interval while the video is playing</li>
</ul>
<div name="resized" data-unique="resized"></div><h3><strong>resized</strong></h3>
<div class="highlight"><pre><span class="nx">hapyak</span><span class="p">.</span><span class="nx">context</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s2">"resized"</span><span class="p">,</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'Player is becoming smaller'</span><span class="p">);</span>
<span class="p">});</span>
</pre></div>


<ul>
<li>Emitted when the player is resized relative to the window</li>
</ul>
<div name="play" data-unique="play"></div><h3><strong>play</strong></h3>
<div class="highlight"><pre><span class="nx">hapyak</span><span class="p">.</span><span class="nx">context</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s2">"play"</span><span class="p">,</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"Video is currently playing"</span><span class="p">);</span>
<span class="p">});</span>
</pre></div>


<ul>
<li>Emitted when the video begins playing</li>
</ul>
<div name="pause" data-unique="pause"></div><h3><strong>pause</strong></h3>
<div class="highlight"><pre><span class="nx">hapyak</span><span class="p">.</span><span class="nx">context</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s2">"pause"</span><span class="p">,</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'Player has been paused'</span><span class="p">);</span>
<span class="p">});</span>
</pre></div>


<ul>
<li>Emitted when the video becomes paused</li>
</ul>
<div name="iframehide" data-unique="iframehide"></div><h3><strong>iframehide</strong></h3>
<div class="highlight"><pre><span class="nx">hapyak</span><span class="p">.</span><span class="nx">context</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s2">"iframehide"</span><span class="p">,</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'Iframe annotation is no longer visible'</span><span class="p">);</span>
<span class="p">});</span>
</pre></div>


<ul>
<li>Emitted when the IFRAME annotation passes its end time &amp; is hidden</li>
</ul>
<div name="editModeChange" data-unique="editModeChange"></div><h3><strong>editModeChange</strong></h3>
<div class="highlight"><pre><span class="nx">hapyak</span><span class="p">.</span><span class="nx">context</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s2">"editModeChange"</span><span class="p">,</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'Video is currently being edited'</span><span class="p">);</span>
<span class="p">});</span>
</pre></div>


<ul>
<li>Emitted when the edit mode is changed within the HapYak editor.</li>
</ul>
<div name="playerHover" data-unique="playerHover"></div><h3><strong>playerHover</strong></h3>
<div class="highlight"><pre><span class="nx">hapyak</span><span class="p">.</span><span class="nx">context</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s2">"playerHover"</span><span class="p">,</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'Mouse is being hovered within the player'</span><span class="p">);</span>
<span class="p">});</span>
</pre></div>


<ul>
<li>Emitted when a hover event occurs over the player. This event as a returned value of true or false for hovering or not hovering respectively.</li>
</ul>
<div name="Object:Tracking" data-unique="Object:Tracking"></div><h2>Object: Tracking</h2>
<p><strong>hapyak.context.tracking.widgetAction(action, properties)</strong></p>
<p>Allows partners to track custom analytics.</p>
<div class="highlight"><pre><span class="nx">trackButton</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span> <span class="s2">"click"</span><span class="p">,</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
  <span class="nx">hapyak</span><span class="p">.</span><span class="nx">context</span><span class="p">.</span><span class="nx">tracking</span><span class="p">.</span><span class="nx">widgetAction</span><span class="p">(</span><span class="s1">'Follow'</span><span class="p">,</span> <span class="p">{</span><span class="s1">'username'</span><span class="o">:</span> <span class="s1">'foobar123'</span><span class="p">});</span>
<span class="p">});</span>
</pre></div>


<ul>
<li>Action: The name of the action being tracked. This can be any string.</li>
<li>Properties: Object of properties you wish to attach to this tracked action. The properties you wish to track is entirely up to you, but must be in true JSON format.</li>
<li>using the VideoJS4 Embed type provided in the share modal, you can add options to the viewer object that will allow you to see, and track your own analytics as seen below:</li>
</ul>
<div class="highlight"><pre>    <span class="nt">&lt;video</span> <span class="na">id=</span><span class="s">"hapyak-player-157199-8825"</span>  <span class="na">class=</span><span class="s">"video-js vjs-default-skin"</span> <span class="na">width=</span><span class="s">"720"</span> <span class="na">height=</span><span class="s">"405"</span> <span class="na">playsinline=</span><span class="s">"playsinline"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;source</span> <span class="na">src=</span><span class="s">"https://sample.hapyak-hosted.com/group_uploads/23/16673/videos/862f7e32a9b94974b98f004ae49fa9ef/Sample-Video-with-sound.mp4"</span> <span class="na">type=</span><span class="s">"video/mp4"</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;/video&gt;</span>
  <span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">"stylesheet"</span> <span class="na">href=</span><span class="s">"//vjs.zencdn.net/4.8/video-js.css"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;script</span> <span class="na">type=</span><span class="s">"text/javascript"</span> <span class="na">src=</span><span class="s">"//vjs.zencdn.net/4.8/video.js"</span><span class="nt">&gt;&lt;/script&gt;</span>

  <span class="nt">&lt;script</span> <span class="na">type=</span><span class="s">"text/javascript"</span> <span class="na">src=</span><span class="s">"//d2qrdklrsxowl2.cloudfront.net/js/hapyak.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
  <span class="nt">&lt;script</span> <span class="na">type=</span><span class="s">"text/javascript"</span><span class="nt">&gt;</span>
      (function () {
          var vjs = videojs('hapyak-player-157199-8825');

          hapyak.viewer({
              apiKey: "12345678910111213",
              projectId: 286041,
              resetVariables: true,
              player: vjs,
              videoType: "html5",
              playerType: "videojs4",
              autoplay: false,
              oncustomtrackingevent: function(data) {
                console.log("custom Data", data)
              }
          });
      })();
  <span class="nt">&lt;/script&gt;</span>
</pre></div>


<ul>
<li>for more information on the viewer object check out <a href="http://dev.hapyak.com/docs/hapyak-embed-api/#ViewerAPI">these docs</a></li>
</ul>
<div name="SessionVariables" data-unique="SessionVariables"></div><h2>Session Variables</h2>
<p>These variables only exists during the session…
Setting variables via the Extension API is functionally equivalent to passing in a "variables" object on the Viewer.</p>
<p>OBJECT: <code>hapyak.context.env</code></p>
<div name="METHOD:set(name,value,temp,scope)" data-unique="METHOD:set(name,value,temp,scope)"></div><h3><strong>METHOD: set(name, value, temp, scope)</strong></h3>
<div class="highlight"><pre><span class="nx">hapyak</span><span class="p">.</span><span class="nx">context</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">'obj'</span><span class="p">,</span> <span class="p">{</span><span class="nx">name</span><span class="o">:</span> <span class="s2">"Andrew"</span><span class="p">,</span> <span class="nx">anotherName</span><span class="o">:</span> <span class="s2">"Homer J Simpson"</span><span class="p">},</span> <span class="kc">false</span><span class="p">,</span> <span class="s1">'track'</span><span class="p">);</span>
</pre></div>


<p>Sets the value of the variable by name.</p>
<ul>
<li><code>temp</code> if true, the value will not be captured to the browser local storage. (default: false)</li>
<li><code>scope</code> should be set to track to make the data available to other annotations. (default: annotation scope)</li>
<li>Variables where <code>scope</code> is <code>annotation scope</code>, there is no limitation to the data types that can be used.</li>
</ul>
<p>Based on the example above, if we wanted to access the data from the the variable <code>obj</code> we could do so in a text annotation like this:</p>
<p><img alt="alt text" src="https://hapyak-documentation.s3.amazonaws.com/extension-api/content/images/OBJ.name+pic.png"></p>
<p>The variable would resolve after the function is called:
<img alt="alt text" src="https://hapyak-documentation.s3.amazonaws.com/extension-api/content/images/resolved+variable.png"></p>
<div name="METHOD:get(name)" data-unique="METHOD:get(name)"></div><h3><strong>METHOD: get(name)</strong></h3>
<div class="highlight"><pre>  <span class="nx">hapyak</span><span class="p">.</span><span class="nx">context</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'name'</span><span class="p">)</span>
</pre></div>


<ul>
<li>
<p>Returns the value of the variable by <code>name</code>.</p>
</li>
<li>
<p><code>set</code> sets data asynchronously, so if you call <code>get</code> immediately after <code>set</code> and before
the <code>data</code> event fires, the values may be different.</p>
</li>
</ul>
<p>To return annotation data in current project:</p>
<div class="highlight"><pre><span class="nx">hapyak</span><span class="p">.</span><span class="nx">context</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s2">"data"</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span> <span class="c1">//wait for data event to fire</span>
<span class="nx">hapyak</span><span class="p">.</span><span class="nx">context</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'projectAnnotations'</span><span class="p">)</span>
<span class="p">})</span>
</pre></div>


<div name="METHOD:clear(name)" data-unique="METHOD:clear(name)"></div><h3><strong>METHOD: clear(name)</strong></h3>
<div class="highlight"><pre>  <span class="nx">hapyak</span><span class="p">.</span><span class="nx">context</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">clear</span><span class="p">(</span><span class="s1">'name'</span><span class="p">)</span>
</pre></div>


<ul>
<li>Clears the value of a single variable by <code>name</code>.</li>
</ul>
<div name="NOTES:" data-unique="NOTES:"></div><h2>NOTES:</h2>
<p>Any variables set with env.set are changed asynchronously because they need time to be communicated to the parent window. The new value will not be returned by env.get until the next "data" event fires, which should occur within a few milliseconds.</p>
<div class="highlight"><pre><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">hapyak</span><span class="p">.</span><span class="nx">context</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'myData'</span><span class="p">));</span> <span class="c1">//foo</span>
<span class="nx">hapyak</span><span class="p">.</span><span class="nx">context</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">'myData'</span><span class="p">,</span> <span class="s1">'bar'</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">hapyak</span><span class="p">.</span><span class="nx">context</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'myData'</span><span class="p">));</span> <span class="c1">//foo</span>
<span class="nx">hapyak</span><span class="p">.</span><span class="nx">context</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">'data'</span><span class="p">,</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">hapyak</span><span class="p">.</span><span class="nx">context</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'myData'</span><span class="p">));</span> <span class="c1">//bar</span>
<span class="p">});</span>
</pre></div>

</article>